% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/EXTENSION_UTILS.R
\name{extend_msa}
\alias{extend_msa}
\title{Merge Patch MSAs Across Structural Chains or Regions}
\usage{
extend_msa(aln_info_set1, aln_info_set2, msa_info_set, use_sample_names = TRUE)
}
\arguments{
\item{aln_info_set1}{A named list from \code{aln_msa_to_pdb()} or previous \code{extend_msa()} output.}

\item{aln_info_set2}{A second alignment info set from another chain or region (also from \code{aln_msa_to_pdb()} or \code{extend_pdb()}).}

\item{msa_info_set}{A named list of full MSA matrices from \code{WRAPPER_msa_to_ref()}, containing \code{msa1}, \code{msa2}, etc.}

\item{use_sample_names}{Logical; if \code{TRUE}, sequences will be matched by FASTA header during MSA merging. If \code{FALSE}, rows are merged by order.}
}
\value{
A list with:
\describe{
  \item{\code{msa_subsets}}{A combined list of MSA patch subsets, merged across MSAs and structural chains.}
  \item{\code{aln_df}}{A residue-level metadata table that includes merged patch and codon information across inputs.}
}
}
\description{
This function extends residue- and patch-level alignment data across independently aligned chains
or MSA regions that share a common codon reference. It merges patch metadata and corresponding
MSA subsets across input alignment sets, resolving codon patches, rescuing orphaned mappings, and
concatenating per-codon MSA slices across chains or models.
}
\details{
This function enables chain-aware patch merging by propagating patch definitions across residue matches
and codon positions shared across independently aligned structures. Codon-level MSA subsets are updated
to reflect the union of observed residues across chains. Interface rows are preserved, and orphans
(residues with MSA mapping but no associated patch) are rescued using cross-reference with the alternate chain.

Repeated calls to \code{extend_msa()} allow recursive merging of additional chains or MSA blocks.
}
\seealso{
\code{\link{extend_pdb}}, \code{\link{aln_msa_to_pdb}}, \code{\link{WRAPPER_msa_to_ref}}
}
