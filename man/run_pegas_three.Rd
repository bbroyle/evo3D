% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ANALYSIS_UTILS.R
\name{run_pegas_three}
\alias{run_pegas_three}
\title{Calculate Diversity and Neutrality Statistics for MSA Subsets}
\usage{
run_pegas_three(msa, residue_df = NULL, stat = c("pi", "tajima", "hap"))
}
\arguments{
\item{msa}{Either a single nucleotide alignment (matrix or DNAbin) or a named list of alignments (one per patch).}

\item{residue_df}{Optional data frame containing at minimum a column \code{msa_subset_id}.
If provided, statistics will be merged into this data frame.}

\item{stat}{Character vector indicating which statistics to compute. Options: \code{"pi"}, \code{"tajima"}, \code{"hap"}.}
}
\value{
A data frame with one row per alignment window (matching \code{msa_subset_id}),
including columns for each requested statistic.
}
\description{
Computes per-patch summary statistics for nucleotide alignments, including nucleotide diversity (\code{pi}),
Tajima's D, and haplotype diversity. Accepts either a single MSA or a list of patch-level MSAs.
}
\details{
This function is typically used downstream of \code{aln_msa_to_pdb()} to quantify evolutionary variation
within each structure-informed alignment window.
}
