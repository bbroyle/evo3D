% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/EXTENSION_UTILS.R
\name{extend_pdb}
\alias{extend_pdb}
\title{Merge Codon Patch Definitions Across Structures}
\usage{
extend_pdb(aln_info_set1, aln_info_set2, msa_info)
}
\arguments{
\item{aln_info_set1}{A named list from \code{aln_msa_to_pdb()} or previous \code{extend_pdb()} output.}

\item{aln_info_set2}{A new alignment info set (output of \code{aln_msa_to_pdb()} for a new structure or chain).}

\item{msa_info}{Output of \code{WRAPPER_msa_to_ref()}, containing the full codon-aligned MSA matrix.}
}
\value{
A list with:
\describe{
  \item{\code{msa_subsets}}{A named list of updated MSA patch subsets, merged across structures.}
  \item{\code{aln_df}}{A unified residue-level metadata table including all merged structures.}
}
}
\description{
This function combines patch metadata from two aligned PDB structures (or chain combinations)
that share a reference MSA. For codons present in both inputs, it performs a union of the
patch windows and updates the corresponding MSA subsets. It supports recursive application
to successively integrate additional models.
}
\details{
This function allows progressive patch merging across structural models by tagging each new set
of PDB columns (e.g., \code{pdb2_residue_id}, \code{pdb3_residue_id}, etc.). Interface and orphan
rows are preserved. Patch subsets from \code{aln_info_set2} are added to the master list unless
already present.
}
