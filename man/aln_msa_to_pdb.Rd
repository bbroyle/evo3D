% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ALN_MODULE.R
\name{aln_msa_to_pdb}
\alias{aln_msa_to_pdb}
\title{Align Protein Structure to MSA and Extract Codon-Level Windows}
\usage{
aln_msa_to_pdb(
  msa_info,
  pdb_info,
  chain = NA,
  drop_unused_residues = TRUE,
  verbose = 1
)
}
\arguments{
\item{msa_info}{A named list output from \code{WRAPPER_msa_to_ref()}, containing the MSA matrix and reference peptide sequence.}

\item{pdb_info}{A named list output from \code{WRAPPER_pdb_to_patch()}, including PDB-derived sequences and residue/patch annotations.}

\item{chain}{Character string indicating the chain to analyze. Required.}

\item{drop_unused_residues}{Logical; if \code{TRUE}, drops PDB residues not linked to codon-level info.}
}
\value{
A list with:
\describe{
  \item{aln_coverage}{Named list of alignment coverage ranges.}
  \item{aln_df}{Data frame mapping residues to codons, amino acids, and patch identifiers.}
  \item{msa_subsets}{Named list of nucleotide MSA matrices, one per patch.}
}
}
\description{
Module for aligning a structure-derived protein sequence to the reference sequence in a multiple
sequence alignment (MSA), mapping 3D patches to codon-level positions, and extracting corresponding
nucleotide windows. This forms the bridge between structure and sequence in the evo3D pipeline.
}
\details{
This function is a core module in the evo3D workflow and is called internally by \code{run_evo3d()}.
It chains together multiple submodules to produce codon-aligned MSA subsets for each structural patch.
}
