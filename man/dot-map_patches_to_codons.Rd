% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ALN_MODULE.R
\name{.map_patches_to_codons}
\alias{.map_patches_to_codons}
\title{Map Protein Patch Regions to Codon Coordinates}
\usage{
.map_patches_to_codons(pos_aln, residue_df)
}
\arguments{
\item{pos_aln}{A 2-row alignment matrix with codon indices (row 1) and residue indices (row 2), from \code{.map_aln_to_positions()}.}

\item{residue_df}{Data frame of patch-level residues, containing at minimum \code{residue_id} and \code{patch} columns.}
}
\value{
A data frame matching residues to codon-based patch identifiers, with columns:
\describe{
  \item{residue_id}{PDB residue identifier}
  \item{codon}{Codon position in the alignment}
  \item{codon_patch}{Codon-based patch identifier (e.g., "15+22+27")}
  \item{msa_subset_id}{Unique ID used to extract the corresponding MSA subset}
}
}
\description{
Converts patch-level residue groupings (e.g., structural surface patches) into codon-aligned nucleotide coordinates
based on a dual-layer alignment matrix produced by \code{.map_aln_to_positions()}.
}
\details{
This function creates \code{codon_patch} strings for each residue, encoding the codons that make up its structural context.
Also assigns a unique \code{msa_subset_id} used for downstream patch extraction.
}
