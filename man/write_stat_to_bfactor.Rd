% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ANALYSIS_UTILS.R
\name{write_stat_to_bfactor}
\alias{write_stat_to_bfactor}
\title{Write Selection Statistics to PDB B-Factors (Codon-Based Mapping)}
\usage{
write_stat_to_bfactor(
  evo3d_results,
  pdb_id = 1,
  stat_name = "tajima",
  outfile = "test.pdb",
  mapped_chains_only = TRUE,
  scale_up_pi = FALSE,
  adjust_NA_stats = -10
)
}
\arguments{
\item{evo3d_results}{Output from \code{run_evo3d()}, including \code{evo3d_df} and structure info.}

\item{pdb_id}{Numeric index for the target PDB (e.g., 1 for \code{pdb1}). Defaults to 1.}

\item{stat_name}{Name of the statistic column in \code{evo3d_df} to embed (e.g., \code{"tajima"}, \code{"pi"}).}

\item{outfile}{Output path for the modified PDB file.}

\item{mapped_chains_only}{Logical; if \code{TRUE}, only atoms from chains used in the analysis will be retained.}

\item{scale_up_pi}{Logical; if \code{TRUE} and \code{stat_name == "pi"}, small values will be scaled for PyMOL visibility.}

\item{adjust_NA_stats}{Numeric value to assign to residues with missing statistic values (default: -10).}
}
\value{
No R return value. A PDB file is written to \code{outfile} with modified B-factor values.
}
\description{
Maps codon-aligned selection statistics (e.g., Tajima's D, nucleotide diversity) to B-factors in a PDB structure file.
This enables visualization of selection results in molecular viewers such as PyMOL or Chimera.
}
\details{
This function operates on output from \code{run_evo3d()} and uses codon-patch-to-structure mappings to embed
a selected statistic into the B-factor field of a target PDB.
}
