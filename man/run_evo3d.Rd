% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/WRAPPER_MODULE.R
\name{run_evo3d}
\alias{run_evo3d}
\title{Run evo3D Workflow}
\usage{
run_evo3d(
  msa,
  pdb,
  chain = "auto",
  interface_chain = NA,
  occlusion_chain = NA,
  compute_stats = TRUE,
  detail_level = 1,
  verbose = 1,
  restart_run = NULL,
  user_aln = NULL,
  msa_controls = list(),
  pdb_controls = list(),
  aln_controls = list(),
  stat_controls = list(),
  output_controls = list()
)
}
\arguments{
\item{msa}{A matrix, file path, or list of MSAs (character matrices, fasta objects, or file paths).}

\item{pdb}{A \code{bio3d} PDB object or list of such objects.}

\item{chain}{Chain ID(s) to analyze. Can be "auto", a character, vector, or nested list.}

\item{interface_chain}{Chain(s) to include in interface-based patching (optional).}

\item{occlusion_chain}{Chain(s) to include in occlusion masking for RSA (optional).}

\item{compute_stats}{Logical; whether to calculate nucleotide diversity, Tajima’s D, etc. (default: \code{TRUE}).}

\item{detail_level}{Controls the level of detail in the returned R object.

\describe{
  \item{0}{Return only `evo3d_df` and `pdb_info_sets`. Minimal memory usage. Suitable for post hoc visualization and writing to PDB files, but not for restart or stat recomputation.}
  \item{1}{Adds `msa_info_sets`, enabling restart with user-provided alignments. Does not include full alignment-to-structure mappings or subsets.}
  \item{2}{Adds full `msa_subsets` and MSA-to-PDB patch mappings, allowing for patch-level stat recomputation or post hoc reruns on individual structures.}
}}

\item{verbose}{Controls the verbosity of printed output.

\describe{
  \item{0}{Silent mode. Only errors or critical messages are printed.}
  \item{1}{Basic progress updates showing which module is running.}
  \item{2}{Detailed output, including all submodular steps.}
 }}

\item{restart_run}{A previous evo3d run object used to restart the pipeline (e.g., after alignment failure or to reuse mapped PDB metadata).}

\item{user_aln}{A user-provided MSA aligned to the reference sequence. Can be a single alignment or a list (for multi-run pipelines). Used in conjunction with \code{restart_run}.}

\item{msa_controls}{List of control parameters for MSA preprocessing (e.g. \code{ref_method}, \code{force_seqtype}).}

\item{pdb_controls}{List of control parameters for patch definition (e.g. \code{patch.dist.cutoff}, \code{rsa.method}).}

\item{aln_controls}{List of control parameters for MSA–structure alignment (if applicable).}

\item{stat_controls}{List of control parameters for patch-level statistic calculations (e.g. \code{calc_pi}, \code{calc_tajima}).}

\item{output_controls}{List of control parameters for output formatting (e.g. \code{output_format}, \code{output_dir}).}
}
\value{
A list containing:
\item{evo3d_df}{Final data frame with codon-level mappings and statistics.}
\item{final_msa_subsets}{Patch-level MSAs used in downstream statistics.}
\item{msa_info_sets}{Reference and peptide information for each input MSA.}
\item{pdb_info_sets}{Structure and patch data for each input PDB.}
\item{aln_info_sets}{Codon-level alignment mappings from MSA to PDB.}
\item{call_info}{Cached input metadata and control parameters.}
}
\description{
Full evo3D wrapper to align MSA(s) and PDB(s), generate 3D-defined patches, codon mappings, and selection statistics.
Handles homomultimers and multi-model structures automatically.
}
